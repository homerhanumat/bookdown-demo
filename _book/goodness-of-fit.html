<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Elementary Statistics with R</title>
  <meta content="text/html; charset=UTF-8" http-equiv="Content-Type">
  <meta name="description" content="These are course notes for MAT 111 at Georgetown College. They are greatly in need of revision.">
  <meta name="generator" content="bookdown 0.0.71 and GitBook 2.6.7">

  <meta property="og:title" content="Elementary Statistics with R" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="These are course notes for MAT 111 at Georgetown College. They are greatly in need of revision." />
  <meta name="github-repo" content="homerhanumat/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Elementary Statistics with R" />
  
  <meta name="twitter:description" content="These are course notes for MAT 111 at Georgetown College. They are greatly in need of revision." />
  

<meta name="author" content="Rebekah Robinson and Homer White">

<meta name="date" content="2016-05-18">

<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  TeX: { equationNumbers: { autoNumber: "AMS" } }
});
</script>

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="tests-of-significance.html">
<link rel="next" href="chapter-2.html">

<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>


  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Elementary Statistics With R</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a></li>
<li class="chapter" data-level="2" data-path="describing-patterns-in-data.html"><a href="describing-patterns-in-data.html"><i class="fa fa-check"></i><b>2</b> Describing Patterns in Data</a></li>
<li class="chapter" data-level="3" data-path="relationships-between-two-factor-variables.html"><a href="relationships-between-two-factor-variables.html"><i class="fa fa-check"></i><b>3</b> Relationships Between Two Factor Variables</a></li>
<li class="chapter" data-level="4" data-path="relationships-between-two-numerical-variables.html"><a href="relationships-between-two-numerical-variables.html"><i class="fa fa-check"></i><b>4</b> Relationships Between Two Numerical Variables</a></li>
<li class="chapter" data-level="5" data-path="sampling-and-surveys.html"><a href="sampling-and-surveys.html"><i class="fa fa-check"></i><b>5</b> Sampling and Surveys</a></li>
<li class="chapter" data-level="6" data-path="design-of-studies.html"><a href="design-of-studies.html"><i class="fa fa-check"></i><b>6</b> Design of Studies</a></li>
<li class="chapter" data-level="7" data-path="basic-probability.html"><a href="basic-probability.html"><i class="fa fa-check"></i><b>7</b> Basic Probability</a></li>
<li class="chapter" data-level="8" data-path="probability-in-sampling.html"><a href="probability-in-sampling.html"><i class="fa fa-check"></i><b>8</b> Probability in Sampling</a></li>
<li class="chapter" data-level="9" data-path="confidence-intervals.html"><a href="confidence-intervals.html"><i class="fa fa-check"></i><b>9</b> Confidence Intervals</a></li>
<li class="chapter" data-level="10" data-path="tests-of-significance.html"><a href="tests-of-significance.html"><i class="fa fa-check"></i><b>10</b> Tests of Significance</a></li>
<li class="chapter" data-level="11" data-path="goodness-of-fit.html"><a href="goodness-of-fit.html"><i class="fa fa-check"></i><b>11</b> Goodness of Fit</a><ul>
<li class="chapter" data-level="11.1" data-path="goodness-of-fit.html"><a href="goodness-of-fit.html#the-gamblers-die"><i class="fa fa-check"></i><b>11.1</b> The Gambler’s Die</a></li>
<li class="chapter" data-level="11.2" data-path="goodness-of-fit.html"><a href="goodness-of-fit.html#chisqtestgc-for-goodness-of-fit"><i class="fa fa-check"></i><b>11.2</b> chisqtestGC() for Goodness of Fit</a><ul>
<li class="chapter" data-level="11.2.1" data-path="goodness-of-fit.html"><a href="goodness-of-fit.html#the-gamblers-die-as-a-test-of-significance"><i class="fa fa-check"></i><b>11.2.1</b> The Gambler’s Die as a Test of Significance</a></li>
<li class="chapter" data-level="11.2.2" data-path="goodness-of-fit.html"><a href="goodness-of-fit.html#facts-about-chi2-goodness-of-fit"><i class="fa fa-check"></i><b>11.2.2</b> Facts About <span class="math inline">\(\chi^2\)</span> Goodness of Fit</a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="goodness-of-fit.html"><a href="goodness-of-fit.html#further-example-seating-preference"><i class="fa fa-check"></i><b>11.3</b> Further Example: Seating Preference</a></li>
<li class="chapter" data-level="11.4" data-path="goodness-of-fit.html"><a href="goodness-of-fit.html#further-example-nexus-attendance"><i class="fa fa-check"></i><b>11.4</b> Further Example: Nexus Attendance</a></li>
<li class="chapter" data-level="11.5" data-path="goodness-of-fit.html"><a href="goodness-of-fit.html#further-example-too-good-to-be-true"><i class="fa fa-check"></i><b>11.5</b> Further Example: Too Good to be True?</a></li>
<li class="chapter" data-level="11.6" data-path="goodness-of-fit.html"><a href="goodness-of-fit.html#thoughts-about-r"><i class="fa fa-check"></i><b>11.6</b> Thoughts About R</a><ul>
<li class="chapter" data-level="11.6.1" data-path="goodness-of-fit.html"><a href="goodness-of-fit.html#names-for-elements-in-a-list"><i class="fa fa-check"></i><b>11.6.1</b> Names for Elements in a List</a></li>
<li class="chapter" data-level="11.6.2" data-path="goodness-of-fit.html"><a href="goodness-of-fit.html#quick-null-probabilities"><i class="fa fa-check"></i><b>11.6.2</b> Quick Null Probabilities</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="12" data-path="chapter-2.html"><a href="chapter-2.html"><i class="fa fa-check"></i><b>12</b> Chapter 2</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Elementary Statistics with R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="goodness-of-fit" class="section level1">
<h1><span class="header-section-number">Chapter 11</span> Goodness of Fit</h1>
<p>At the beginning of Chapter Two our very first foray into Descriptive Statistics concerned exploring the distribution of a single factor variable. In this Chapter we will introduce a way to address inferential aspects of Research Questions about one factor variable.</p>
<div id="the-gamblers-die" class="section level2">
<h2><span class="header-section-number">11.1</span> The Gambler’s Die</h2>
<p>Imagine that you are the Sheriff of a small town in the Wild, Wild West. A professional gambler comes to town, and sets up shop in the local saloon. He claims to play with a fair die, but he wins so much that the locals have begun to mutter that his die is loaded. Since loaded dice are illegal in your town, it is up to you to investigate. You impound the die.</p>
<p>Ideally, you would take the die apart to see if it is weighted in one direction or another, but the gambler claims that it is his “lucky” die, and he begs you to do it no harm. You decide to roll it a few times, instead.</p>
<p>There are other pressing law enforcement matters in the town—gunfights, and the like—so you have time only for sixty rolls. The results of the rolls are in the Table [60 Rolls of a Die].</p>
<table>
<caption>60 Rolls of a Die</caption>
<thead>
<tr class="header">
<th align="left"><strong>Spots</strong></th>
<th align="left">One</th>
<th align="left">Two</th>
<th align="left">Three</th>
<th>Four</th>
<th align="left">Five</th>
<th align="left">Six</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><strong>Freq</strong></td>
<td align="left">8</td>
<td align="left">18</td>
<td align="left">11</td>
<td>7</td>
<td align="left">9</td>
<td align="left">7</td>
</tr>
</tbody>
</table>
<p>At once your eye is drawn to the rather large number of two-spots. After all, if the six-sided die is really fair then the chance of a two-spot on any given roll is only 1 in 6, so you would expect only about ten twos in 60 rolls—give or take a few, of course, for chance variation.</p>
<p>The locals notice the large number of twos as well. They pull out their computers, fire up R, and perform a quick One-Proportion test with <code>binomtestGC()</code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">binomtestGC</span>(<span class="dt">x=</span><span class="dv">18</span>,<span class="dt">n=</span><span class="dv">60</span>,<span class="dt">p=</span><span class="dv">1</span>/<span class="dv">6</span>)</code></pre></div>
<pre><code>## Exact Binomial Procedures for a Single Proportion p:
##  Results based on Summary Data
## 
## Descriptive Results:  18 successes in 60 trials
## 
## Inferential Results:
## 
## Estimate of p:    0.3 
## SE(p.hat):    0.0592 
## 
## 95% Confidence Interval for p:
## 
##           lower.bound         upper.bound          
##           0.188451            0.432083             
## 
## Test of Significance:
## 
##  H_0:  p = 0.1666667 
##  H_a:  p != 0.1666667 
## 
##  P-value:        P = 0.0089</code></pre>
<p>The results show that if the die is really fair, then the chance of 18 or more twos in sixty rolls is only about 0.009, which is less than 1%. The locals prepare to ride the gambler out of town on a rail.</p>
<p>You, on the other hand, know about Data Snooping, the dangerous practice of performing a test on the basis of a pattern you notice in your data. You know that it’s not really fair to concoct a test on the proportion of twos, simply because the twos grab your attention: after all, the tally of the 60 rolls has six counts—one for each side of the die—and it stands to reason that one or more of the counts might depart quite a bit from its expected value of 10, just by chance variation.</p>
<p>What you need is a test that takes all of the data, not just the count of twos, into account in an even-handed way. This need puts you in mind of the <span class="math inline">\(\chi^2\)</span>-statistic from Chapter Three:</p>
<p><span class="math display">\[\chi^2=\sum_{\text{all cells}} \frac{(\text{Observed}-\text{Expected})^2}{\text{Expected}}.\]</span></p>
<p>You table of counts has six cells, and if the die is fair then the expected count for each cell is 10—one-sixth of the 60 rolls. You compute the <span class="math inline">\(\chi^2\)</span>-statistic for the tally of the sixty rolls:</p>
<p><span class="math display">\[\chi^2 = \frac{(8-10)^2}{10}+\frac{(18-10)^2}{10}+\frac{(11-10)^2}{10} \\
+\frac{(7-10)^2}{10}+\frac{(9-10)^2}{10}+\frac{(7-10)^2}{10} \\
= 8.8.\]</span></p>
<p>The result is 8.8. But you wonder: is this value too big to be explained as just due to chance variation in the sixty rolls of a fair die?</p>
<p>Fortunately you have access to a simulator that will perform the following task:</p>
<ul>
<li>it will roll a fair die 60 times;</li>
<li>it will tally the results, getting a table of observed counts;</li>
<li>it will compute the <span class="math inline">\(\chi^2\)</span>-statistic for the table thus obtained;</li>
<li>it will repeat the preceding three steps as many times as you like, keeping track of the results and checking to see how many of them exceed the 8.8 value that you got in your actual study of the gambler’s die.</li>
</ul>
<p>In order to use the simulator, you need to put together the table of observed counts:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">throws &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dt">one=</span><span class="dv">8</span>,<span class="dt">two=</span><span class="dv">18</span>,<span class="dt">three=</span><span class="dv">11</span>,
            <span class="dt">four=</span><span class="dv">7</span>,<span class="dt">five=</span><span class="dv">9</span>,<span class="dt">six=</span><span class="dv">7</span>)</code></pre></div>
<p>You also need to make a list of the probabilities for getting each of the six possible sides. These probabilities are based on the temporary assumption that the die really is fair, so they are all equal to <span class="math inline">\(1/6\)</span>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">NullProbs &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="dv">1</span>/<span class="dv">6</span>,<span class="dv">6</span>)</code></pre></div>
<p>Now you are ready to put this information into the simulator, the function <code>SlowGoodness()</code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">SlowGoodness</span>(throws,NullProbs)</code></pre></div>
<p>Try the simulator for a good number of re-samples. It does not seem terribly unlikely that a fair die would produce a 60-roll tally with a <span class="math inline">\(\chi^2\)</span>-statistic of 8.8 or more. Certainly the chance appears to be much larger than the 1% figure you were getting from <code>binomtestGC()</code>. Maybe the gambler is honest, after all, and the large number of twos was just a fluke.</p>
</div>
<div id="chisqtestgc-for-goodness-of-fit" class="section level2">
<h2><span class="header-section-number">11.2</span> chisqtestGC() for Goodness of Fit</h2>
<p>The above procedure can be formulated in terms of a test of significance, which is called a <em>goodness-of-fit</em> test because it tests whether the observed values of some factor variable can reasonably be said to “fit” a given distribution.</p>
<div id="the-gamblers-die-as-a-test-of-significance" class="section level3">
<h3><span class="header-section-number">11.2.1</span> The Gambler’s Die as a Test of Significance</h3>
<p>In the foregoing study the factor variable at issue was <strong>spots</strong>, the number of spots on the upward-facing die, after it is thrown. The given distribution is the set of probabilities for each side that amounts to the gambler’s claim that the die is fair. These “Null” probabilities appear in Table [Fair Die Probabilities].</p>
<table>
<caption>Fair Die Probabilities</caption>
<thead>
<tr class="header">
<th align="left"><strong>Spots</strong></th>
<th align="left">One</th>
<th align="left">Two</th>
<th align="left">Three</th>
<th>Four</th>
<th align="left">Five</th>
<th align="left">Six</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><strong>Prob</strong></td>
<td align="left">1/6</td>
<td align="left">1/6</td>
<td align="left">1/6</td>
<td>1/6</td>
<td align="left">1/6</td>
<td align="left">1/6</td>
</tr>
</tbody>
</table>
<p>Now we are ready for the test.</p>
<p><strong>Step One</strong>: Statement of Hypotheses</p>
<blockquote>
<p><span class="math inline">\(H_0\)</span>: The die is fair (all sides have probability <span class="math inline">\(1/6\)</span>).</p>
</blockquote>
<blockquote>
<p><span class="math inline">\(H_a\)</span>: The die is weighted (at least one side has probability <span class="math inline">\(\neq 1/6\)</span>)</p>
</blockquote>
<p><strong>Step Two</strong>: Safety Check and Test Statistic</p>
<p>For safety, all that is needed is to know that the 60 tosses of the die were random.</p>
<p>As for the test statistic and other information needed in future steps, we run <code>chisqtestGC()</code>. We must provide</p>
<ul>
<li>the table of observed counts, and</li>
<li>an argument <code>p</code> that gives the probabilities that go with the Null Hypothesis.</li>
</ul>
<p>We also plan to perform simulations in order to compute the P-value, so:</p>
<ul>
<li>We must set the argument <code>simulate.p.value</code> to TRUE;</li>
<li>We should choose the number of re-samples, indicated by the argument <code>B</code>. We’ll set <code>B</code> to 2500.</li>
<li>For reproducibility of results, we should set a seed in advance with the <code>set.seed()</code> function. Quite arbitrarily, we’ll set the seed to 12345.</li>
</ul>
<p>The function call is:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">12345</span>)
throws &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dt">one=</span><span class="dv">8</span>,<span class="dt">two=</span><span class="dv">18</span>,<span class="dt">three=</span><span class="dv">11</span>,
            <span class="dt">four=</span><span class="dv">7</span>,<span class="dt">five=</span><span class="dv">9</span>,<span class="dt">six=</span><span class="dv">7</span>)
NullProbs &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="dv">1</span>/<span class="dv">6</span>,<span class="dv">6</span>)
<span class="kw">chisqtestGC</span>(throws,<span class="dt">p=</span>NullProbs,
             <span class="dt">simulate.p.value=</span>T,<span class="dt">B=</span><span class="dv">2500</span>)</code></pre></div>
<pre><code>## Pearson&#39;s chi-squared test with simulated p-value 
##   (based on 2500 resamples) 
## 
##       Observed counts Expected by Null Contr to chisq stat
## one                 8               10                 0.4
## two                18               10                 6.4
## three              11               10                 0.1
## four                7               10                 0.9
## five                9               10                 0.1
## six                 7               10                 0.9
## 
## 
## Chi-Square Statistic = 8.8 
## Degrees of Freedom of the table = 5 
## P-Value = 0.1152</code></pre>
<p>Note that the output gives the <span class="math inline">\(\chi^2\)</span>-statistic as 8.8.</p>
<p><strong>Step Three</strong>: P-value</p>
<p>The simulated approximation to the P-value is 0.1148.</p>
<blockquote>
<p><strong>Interpretation of P-Value</strong>: <em>If the die is fair, then there is about an 11.48% of getting a <span class="math inline">\(\chi^2\)</span>-statistic at least as large as the one we got in our study of the gambler’s die.</em></p>
</blockquote>
<p><strong>Step Four</strong>: Decision</p>
<blockquote>
<p>Since <span class="math inline">\(P=0.1148 &gt; 0.05\)</span>, we do not reject the Null.</p>
</blockquote>
<p><strong>Step Five</strong> Conclusion</p>
<blockquote>
<p>This study did not provide strong evidence that the gambler’s die was loaded.</p>
</blockquote>
</div>
<div id="facts-about-chi2-goodness-of-fit" class="section level3">
<h3><span class="header-section-number">11.2.2</span> Facts About <span class="math inline">\(\chi^2\)</span> Goodness of Fit</h3>
<p>Mathematicians have studied the <span class="math inline">\(\chi^2\)</span>-statistic under conditions where sample size is “big enough”, and they have discovered the following:</p>
<ul>
<li>When the Null Hypothesis is true, its EV is <span class="math inline">\(df\)</span>, the “degrees of freedom.”</li>
<li>In the goodness-of-fit situation—i.e., when one factor variable is under investigation—the <span class="math inline">\(df\)</span> figure is:</li>
</ul>
<p><span class="math display">\[df=\text{number of cells}-1.\]</span></p>
<ul>
<li>The standard deviation of the <span class="math inline">\(\chi^2\)</span>-statistic is:</li>
</ul>
<p><span class="math display">\[SD(\chi^2)=\sqrt{2 \times df}.\]</span></p>
<p>Thus, in the Gambler’s Die study,</p>
<p><span class="math display">\[df=6-1=5,\]</span></p>
<p>so if the die is fair then we would expect the <span class="math inline">\(\chi^2\)</span>-statistic to be around 5, give or take</p>
<p><span class="math display">\[\sqrt{2 \times 5}=\sqrt{10} \approx 3.16\]</span></p>
<p>or so. From this point of view, the 8.8 value that we got does not seem very unlikely, if the Null is right: it is not much more than one SD above the EV.</p>
<p>As for what sample size counts as “big enough”&quot; the results we stated above are quite accurate if the Null’s expected cell counts are all at least five. Mathematicians have even discovered a family of random variables, known as the <span class="math inline">\(\chi^2\)</span> family, such that at large sample sizes the <span class="math inline">\(\chi^2\)</span>-statistic behaves like one of the members of this family, the member with the degrees of freedom given by the “cells minus one” formula. Figure [Chi-Square df=5] shows a density curve for the <span class="math inline">\(\chi^2\)</span> curve with 5 degrees of freedom, with the area under the curve after 8.8 shaded in. Note that the area is quite close to the P-value that we obtained through simulation.</p>
<div class="figure"><span id="fig:chisqdf5"></span>
<img src="bookdown-demo_files/figure-html/chisqdf5-1.png" alt="Chi-Square df=5" width="672" />
<p class="caption">
Figure 11.1: Chi-Square df=5
</p>
</div>
<p>Since at large sample sizes the <span class="math inline">\(\chi^2\)</span> density curve will deliver approximately the right P-value, we usually don’t ask for simulation. For the Gambler’s Die study, the function call would be:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">chisqtestGC</span>(throws,<span class="dt">p=</span>NullProbs)</code></pre></div>
<p>If you would like to produce a graph of the P-value, you can do so by setting the <code>graph</code> argument to <code>TRUE</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">chisqtestGC</span>(throws,<span class="dt">p=</span>NullProbs,<span class="dt">graph=</span>T)</code></pre></div>
<p>If you have chose to simulate, you can get a graph of the re-sampled <span class="math inline">\(\chi^2\)</span>-statistics:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">chisqtestGC</span>(throws,<span class="dt">p=</span>NullProbs,
             <span class="dt">simulate.p.value=</span>T,<span class="dt">B=</span><span class="dv">2500</span>,
             <span class="dt">graph=</span><span class="ot">TRUE</span>)</code></pre></div>
<p>If any of the expected cell counts are below five, <code>chisqtestGC()</code> will issue a warning, in which case you should re-run the test using simulation.</p>
</div>
</div>
<div id="further-example-seating-preference" class="section level2">
<h2><span class="header-section-number">11.3</span> Further Example: Seating Preference</h2>
<p>Recalling the seating-preference variable <strong>seat</strong> in the <code>m111survey</code> data frame, one might ask the following</p>
<blockquote>
<p><strong>Research Qeestion</strong>: <em>In the Georgetown College population, is there equal perference for each type of seat: front, middle and back?</em></p>
</blockquote>
<p>In this Research Question, we are interested in the distribution of a single factor variable: <strong>seat</strong>. We can use the <span class="math inline">\(\chi^2\)</span>-goodness of fit test to see whether the data in the <code>m111survey</code> provide strong evidence that the GC population is not indifferent to seat-location.</p>
<p><strong>Step One</strong>: Statement of Hypotheses</p>
<p>If the GC population is indifferent, then the proportion of the populations that prefers each type of seat will be <span class="math inline">\(1/3\)</span>, for each of the three possible values of <strong>seat</strong>.</p>
<p>The Null Hypotheses may then be stated as:</p>
<blockquote>
<p><span class="math inline">\(H_0\)</span>: Each of the three types of seat is preferred by one-third of the GC population.</p>
</blockquote>
<p>The Alternative disagrees:</p>
<blockquote>
<p><span class="math inline">\(H_a\)</span>: At least one of the three proportions claimed by the Null is wrong.</p>
</blockquote>
<p><strong>Step Two</strong>: Safety Check and Test Statistic</p>
<p>For safety, we must assume that the students in <code>m111survey</code> are like a simple random sample from the GC population, at least as far as seating preference is concerned.</p>
<p>For the test statistic and other information needed in subsequent steps, we can use formula-data input to call <code>chisqtestGC()</code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">chisqtestGC</span>(~seat,<span class="dt">data=</span>m111survey,
            <span class="dt">p=</span><span class="kw">c</span>(<span class="dv">1</span>/<span class="dv">3</span>,<span class="dv">1</span>/<span class="dv">3</span>,<span class="dv">1</span>/<span class="dv">3</span>))</code></pre></div>
<pre><code>## Chi-squared test for given probabilities 
## 
##          Observed counts Expected by Null Contr to chisq stat
## 1_front               27            23.67                0.47
## 2_middle              32            23.67                2.93
## 3_back                12            23.67                5.75
## 
## 
## Chi-Square Statistic = 9.1549 
## Degrees of Freedom of the table = 2 
## P-Value = 0.0103</code></pre>
<p>We see that the P-value is about 0.01, which is less than our “cut-off” of 0.05, so we reject the Null and conclude that this data provided strong evidence that GC students are not equally likely to prefer any of the three seating locations. (The middle appears to be most desired.)</p>
</div>
<div id="further-example-nexus-attendance" class="section level2">
<h2><span class="header-section-number">11.4</span> Further Example: Nexus Attendance</h2>
<p>A Nexus event held at Georgetown College in April of the Spring semester was attended by 200 students. The class breakdown of the students is given in Table [Nexus Attendance].</p>
<table>
<caption>Nexus Attendance</caption>
<thead>
<tr class="header">
<th align="left"><strong>Class</strong></th>
<th>Fresh</th>
<th>Soph</th>
<th align="left">Junior</th>
<th>Senior</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><strong>Freq</strong></td>
<td>62</td>
<td>27</td>
<td align="left">33</td>
<td>80</td>
</tr>
</tbody>
</table>
<p>Suppose that is is known that the distribution of class rank at Georgetown College is as follows:</p>
<ul>
<li>30% freshmen,</li>
<li>25% sophomores,</li>
<li>25% juniors,</li>
<li>20% seniors.</li>
</ul>
<p>We are interested in the following</p>
<blockquote>
<p><strong>Research Question</strong>: <em>Is the attendance at April Nexus events like a random sample of GC students?</em></p>
</blockquote>
<p>Note that in this Research Question the distribution of the variable <strong>Class Rank</strong> in the GC population in NOT at issue: everyone knows that it is given by the percentages above. What is at issue is whether the data on this Nexus event show that students are not attending randomly, in the sense that one’s likelihood of attending a Nexus event in April might be associated with one’s class rank.</p>
<p>In this study the hypotheses should be stated as:</p>
<blockquote>
<p><span class="math inline">\(H_0\)</span>: Attendance at the event was random.</p>
</blockquote>
<blockquote>
<p><span class="math inline">\(H_a\)</span>: Likelihood of attendance depended on class rank.</p>
</blockquote>
<p>Information needed for the remaining four steps comes from the following R-code:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Nexus &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dt">fresh=</span><span class="dv">62</span>,<span class="dt">soph=</span><span class="dv">27</span>,<span class="dt">junior=</span><span class="dv">33</span>,<span class="dt">senior=</span><span class="dv">80</span>)
NullClass &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">0.30</span>,<span class="fl">0.25</span>,<span class="fl">0.25</span>,<span class="fl">0.20</span>)
<span class="kw">chisqtestGC</span>(Nexus,<span class="dt">p=</span>NullClass)</code></pre></div>
<pre><code>## Chi-squared test for given probabilities 
## 
##        Observed counts Expected by Null Contr to chisq stat
## fresh               62             60.6                0.03
## soph                27             50.5               10.94
## junior              33             50.5                6.06
## senior              80             40.4               38.82
## 
## 
## Chi-Square Statistic = 55.8482 
## Degrees of Freedom of the table = 3 
## P-Value = 0</code></pre>
<p>The <span class="math inline">\(\chi^2\)</span> statistic was about 55.8. If the Null is true, then it should have been about 3 (the degrees of freedom), give or take</p>
<p><span class="math display">\[\sqrt{2 \times 3}=\sqrt{6} \approx 2.45\]</span></p>
<p>or so. A value of 55.8 looks very bad for the Null!</p>
<p>In fact, if the Null is right then the chance of getting a <span class="math inline">\(\chi^2\)</span>-statistic of 55.8 or more is about <span class="math inline">\(4.5 \times 10^{-12}\)</span>, which is a very tiny number indeed. We reject the Null. This event provided strong evidence that, in April, Nexus attendance depends on class rank.</p>
<p>In fact, from the test output we see that the Null expected about 40.4 seniors to attend, whereas 80 in fact did. Apparently GC seniors are scrambling for last-minute Nexus credits!</p>
</div>
<div id="further-example-too-good-to-be-true" class="section level2">
<h2><span class="header-section-number">11.5</span> Further Example: Too Good to be True?</h2>
<p>Imagine that a statistics professor gives a student the following Homework assignment:</p>
<blockquote>
<p><strong>Assignment</strong>: <em>Familiarize yourself with chance variation by rolling a fair die 6000 times. Turn in a tally of your results.</em></p>
</blockquote>
<p>Most students would find the assignment rather onerous!</p>
<p>Now suppose that the next day the student hands in the results shown in Table [6000 Rolls of a Fair Die?].</p>
<table>
<caption>6000 Rolls of a Fair Die?</caption>
<thead>
<tr class="header">
<th align="left"><strong>Spots</strong></th>
<th align="left">One</th>
<th align="left">Two</th>
<th align="left">Three</th>
<th>Four</th>
<th align="left">Five</th>
<th align="left">Six</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><strong>Freq</strong></td>
<td align="left">1003</td>
<td align="left">998</td>
<td align="left">999</td>
<td>1002</td>
<td align="left">1001</td>
<td align="left">997</td>
</tr>
</tbody>
</table>
<p>The professor observes that each cell count is quite close to what would be expected in 6000 rolls of a fair die. But are the counts perhaps TOO close to what would be expected? In other words:</p>
<blockquote>
<p><strong>Research Question</strong>: <em>Is the observed fit “too good to be true”?</em></p>
</blockquote>
<p>Consider running a <span class="math inline">\(\chi^2\)</span>-goodness of fit test on the data:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">AllegedRolls &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dt">one=</span><span class="dv">1003</span>,<span class="dt">two=</span><span class="dv">998</span>,<span class="dt">three=</span><span class="dv">999</span>,
            <span class="dt">four=</span><span class="dv">1002</span>,<span class="dt">five=</span><span class="dv">1001</span>,<span class="dt">six=</span><span class="dv">997</span>)
FairProbs &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="dv">1</span>/<span class="dv">6</span>,<span class="dv">6</span>)
<span class="kw">chisqtestGC</span>(AllegedRolls,<span class="dt">p=</span>FairProbs)</code></pre></div>
<pre><code>## Chi-squared test for given probabilities 
## 
##       Observed counts Expected by Null Contr to chisq stat
## one              1003             1000                0.01
## two               998             1000                0.00
## three             999             1000                0.00
## four             1002             1000                0.00
## five             1001             1000                0.00
## six               997             1000                0.01
## 
## 
## Chi-Square Statistic = 0.028 
## Degrees of Freedom of the table = 5 
## P-Value = 1</code></pre>
<p>As one might have guessed from the close agreement between observed and expected counts, the <span class="math inline">\(\chi^2\)</span> statistic is quite small, so the P-value—the chance of getting at least this value in 6000 rolls of a fair die—is quite large: it is nearly 100%, in fact.</p>
<p>But think of it the other way around: if the table turned in by the student really was the result of tossing a fair die 6000 times, then what is the chance of getting such a small <span class="math inline">\(\chi^2\)</span>-statistic? It would have to be 1 minus the P-value given in the test output:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="dv">1</span><span class="fl">-0.9999931</span></code></pre></div>
<pre><code>## [1] 6.9e-06</code></pre>
<p>This is a very small chance indeed! It would be reasonable to infer that the student made up the tally table, but did not allow for a realistic amount of chance variation away from the expected cell counts!</p>
</div>
<div id="thoughts-about-r" class="section level2">
<h2><span class="header-section-number">11.6</span> Thoughts About R</h2>
<div id="names-for-elements-in-a-list" class="section level3">
<h3><span class="header-section-number">11.6.1</span> Names for Elements in a List</h3>
<p>When you are working with summary data, you have to provide <code>chisqtestGC()</code> with a tally of the observed counts. The output for the test is most readable if you also provide names for each of the possible values of the factor variable under study. You can do so as you create the lists of observed counts. For example, if your variable has three possible values called “a”, “b” and “c”, with counts 13, 12 and 27 respectively, then you can create a named tally as follows:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">ObsCounts &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dt">a=</span><span class="dv">13</span>,<span class="dt">b=</span><span class="dv">12</span>,<span class="dt">c=</span><span class="dv">27</span>)</code></pre></div>
</div>
<div id="quick-null-probabilities" class="section level3">
<h3><span class="header-section-number">11.6.2</span> Quick Null Probabilities</h3>
<p>For goodness of fit tests, <code>chisqtestGC()</code> requires that the <code>p</code> argument be set to the list of proportions claimed by the Null for the factor variable under study. If these values are all the same, then you can write them quickly using the <code>rep()</code> function.</p>
<p><code>rep()</code> repeats a given value a given number of times. For example to get 7 threes, just type:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">rep</span>(<span class="dv">3</span>,<span class="dv">7</span>)</code></pre></div>
<pre><code>## [1] 3 3 3 3 3 3 3</code></pre>
<p>If there are eight null probabilities and they are all the same, then each would be <span class="math inline">\(1/8\)</span>, so you could set them as follows:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">MyNulls &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="dv">1</span>/<span class="dv">8</span>,<span class="dv">8</span>)
MyNulls</code></pre></div>
<pre><code>## [1] 0.125 0.125 0.125 0.125 0.125 0.125 0.125 0.125</code></pre>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="tests-of-significance.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="chapter-2.html" class="navigation navigation-next " aria-label="Next page""><i class="fa fa-angle-right"></i></a>

<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"facebook": true,
"twitter": true,
"google": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rstudio/bookdown-demo/edit/master/11-GoodnessOfFit.Rmd",
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    if (location.protocol !== "file:" && /^https?:/.test(script.src))
      script.src  = script.src.replace(/^https?:/, '');
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
